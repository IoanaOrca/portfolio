---
import { Image } from 'astro:assets';
import BaseLayout from '@layouts/BaseLayout.astro';
import Section from '@components/Section.astro';
const { data, slug } = Astro.props; // TODO typing

const images = import.meta.glob<ImageMetadata>('/src/assets/recipes/*', { import: 'default' });
const img = await images[`/src/assets/recipes/${data?.image?.src || 'recipes.svg'}`]();
---

<BaseLayout title={data.title}>
  <header>
    <div class="hero bg-base-200 text-base">
      <div class="hero-content flex-col lg:flex-row gap-8 px-8 py-16">
        <div class="avatar">
          <div class="max-w-xs rounded shadow">
            <Image
              src={img.src}
              width={img.width}
              height={img.height}
              alt={data?.image?.alt || ''}
            />
          </div>
        </div>
        <div class="max-w-md flex flex-col gap-6">
          <h1 class="text-5xl font-bold">{ data.title }</h1>
          <p class="">{data.description}</p>
        </div>
      </div>
    </div>
  </header>

  <Section class="prose mx-auto">
    <p>{ data.date.toLocaleDateString() }</p>

    {!!data.tags?.length &&
      <ul class="flex flex-wrap gap-2">
        {
          data.tags.map(tag => (
            <li class="badge badge-outline">
              { tag }
            </li>
          ))
        }
      </ul>
    }

    {!!data.ingredients?.length &&
      <div class="overflow-x-auto">
        <table class="table table-zebra w-full">
          <thead>
            <tr>
              <th>Ingredient</th>
              <th>Quantity</th>
            </tr>
          </thead>
          <tbody>
            {
              data.ingredients.map(ingredient => (
                <tr>
                  <td>
                    { ingredient.name }
                  </td>
                  <td>
                    { ingredient.quantity }
                  </td>
                </tr>
              ))
            }
          </tbody>
        </table>
      </div>
    }

    <slot />

  </Section>
</BaseLayout>
